#!/usr/bin/env bash
set -euo pipefail
echo
echo "========================"
echo "$(basename "$0") Start"
echo "========================"
echo

pause() { read -rp "ê³„ì†í•˜ë ¤ë©´ [Enter] í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”..." _; echo; }

cat <<'B'
========================================
 ë ˆìŠ¨ 20) ì—¬ê¸°ë¬¸ì„œ (Here Document) & í…œí”Œë¦¿ ìƒì„±
========================================
B

echo "[ëª©í‘œ]"
echo "- cat <<EOF ë¬¸ë²•ì„ ì´í•´í•˜ê³ ,"
echo "- ë³€ìˆ˜ í™•ì¥ / ë¹„í™•ì¥ ì°¨ì´ë¥¼ ëˆˆìœ¼ë¡œ í™•ì¸í•˜ë©°,"
echo "- ì‹¤ì œ ì„¤ì •íŒŒì¼ í…œí”Œë¦¿ì„ ìƒì„±í•´ë³¸ë‹¤."
echo

WORK_DIR="/tmp/bash_lesson20"
rm -rf "$WORK_DIR"
mkdir -p "$WORK_DIR"
cd "$WORK_DIR"

# ------------------------------------------------------------
echo "1ï¸âƒ£  ê¸°ë³¸ í˜•íƒœ: cat <<EOF"
NAME="Joshua"
cat <<EOF
Hello, $NAME!
ì˜¤ëŠ˜ì€ Here Documentë¥¼ ë°°ì›ë‹ˆë‹¤.
EOF
pause

# ------------------------------------------------------------
echo "2ï¸âƒ£  ì‘ì€ë”°ì˜´í‘œ ë²„ì „: cat <<'EOF' (ë¦¬í„°ëŸ´ ëª¨ë“œ)"
cat <<'EOF'
ì´ ì•ˆì˜ $NAME ì€ í™•ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ì¦‰, ê²°ê³¼ì— ê·¸ëŒ€ë¡œ '$NAME' ì´ í‘œì‹œë©ë‹ˆë‹¤.
EOF
pause

# ------------------------------------------------------------
echo "3ï¸âƒ£  ë“¤ì—¬ì“°ê¸° í—ˆìš© ë²„ì „: cat <<-EOF"
# íƒ­(tab) ë¬¸ìë¥¼ ë¬´ì‹œí•˜ê³  ë“¤ì—¬ì“°ê¸° ê°€ëŠ¥
cat <<-EOF
	ì´ ë¸”ë¡ì€ íƒ­ìœ¼ë¡œ ë“¤ì—¬ì“°ê¸° í•´ë„ ì¶œë ¥ì—” ì˜í–¥ ì—†ìŠµë‹ˆë‹¤.
	(ë‹¨, ê³µë°±ì€ í—ˆìš©ë˜ì§€ ì•ŠìŒ)
EOF
pause

# ------------------------------------------------------------
echo "4ï¸âƒ£  ì—¬ê¸°ë¬¸ì„œë¥¼ ì´ìš©í•´ íŒŒì¼ ìƒì„±"
cat <<EOF > config.txt
# Sample Config
USER_NAME=$NAME
HOST=localhost
PORT=8080
EOF

echo "ìƒì„±ëœ config.txt ë‚´ìš©:"
cat config.txt
pause

# ------------------------------------------------------------
echo "5ï¸âƒ£  sed ë¡œ í…œí”Œë¦¿ ë³€í™˜ (HOST êµì²´)"
sed -E 's/HOST=.*/HOST=server.local/' config.txt > config_new.txt
echo "ë³€í™˜ëœ config_new.txt ë‚´ìš©:"
cat config_new.txt
pause

# ------------------------------------------------------------
echo "6ï¸âƒ£  awk ë¡œ ì„¤ì •íŒŒì¼ ìš”ì•½"
awk -F= 'NF==2{printf "%-10s â†’ %s\n",$1,$2}' config_new.txt
pause

# ------------------------------------------------------------
echo "7ï¸âƒ£  grep ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì£¼ì„ ì œì™¸ ì¶œë ¥"
grep -vE '^\s*#' config_new.txt
pause

echo "ë ˆìŠ¨ 20 ì™„ë£Œ ğŸ‰"
echo "íŒŒì¼ ìœ„ì¹˜: $WORK_DIR"

echo "========================"
echo "$(basename "$0") End"
echo "========================"
